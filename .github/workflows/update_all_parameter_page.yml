name: Update all parameters wiki page

on:
  workflow_dispatch:
  push:
    branches:
      - wiki_sync_parameter_md

env:
  GIT_AUTHOR_NAME: ${{ github.actor }}
  GIT_AUTHOR_EMAIL: ${{ secrets.MY_EMAIL }}
  GIT_TOKEN: ${{ secrets.TOKEN_FOR_WIKI }}

jobs:
  Update-all-parameters-page:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repo
        uses: actions/checkout@v4
      - name: run script
        run: |
          cd tool/wiki
          python --version
          python sync_runtime_parameter.py
      - name: move markdown
        run: |
          mv tool/wiki/Runtime-Parameters:-All.md doc/wiki/
      - name: set git config
        run: |
          git config --global user.email "${{env.GIT_AUTHOR_NAME}}"
          git config --global user.name "${{env.GIT_AUTHOR_EMAIL}}"
      - name: make a commit and push if the file changed
        run: |
          git diff --exit-code doc/wiki/Runtime-Parameters:-All.md || \
          ( git add doc/wiki/Runtime-Parameters:-All.md && \
          git commit -m "[Workflow] Update all parameters wiki page" && \
          git push )
